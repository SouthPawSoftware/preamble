<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Preamble by jeffschwartz</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Preamble</h1>
        <p class="header">A Powerful JavaScript Unit Testing Framework</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/jeffschwartz/preamble/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/jeffschwartz/preamble/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/jeffschwartz/preamble">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/jeffschwartz">jeffschwartz</a></p>


      </header>
      <section>
        <h1>
<a name="introducing-preamble" class="anchor" href="#introducing-preamble"><span class="octicon octicon-link"></span></a>Introducing Preamble</h1>

<p>Preamble is a powerful unit testing framework for JavaScript that promotes Test Driven Development. Preamble runs in any modern HTML5 compliant browser as well as headless via PhantomJS and has no additional dependencies on any other libraries. Preamble is backed by a very powerful assertion engine that your unit tests interface with through a very simple to use but powerful API, which makes the task of authoring tests very easy and intuitive.</p>

<p>This is an example of a simple asynchronous test</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'truthy'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">'true === true'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="kc">true</span> <span class="o">===</span> <span class="kc">true</span><span class="p">,</span> <span class="s1">'true === true'</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<p>and this is an example of a simple asynchronous test.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'asynchronous'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">asyncTest</span><span class="p">(</span><span class="s1">'fetch data from database via Ajaax'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">catsCollection</span><span class="p">;</span>
        <span class="kd">var</span> <span class="nx">prxy</span> <span class="o">=</span> <span class="nx">proxy</span><span class="p">();</span>
        <span class="kd">var</span> <span class="nx">promise</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">catscollection</span><span class="p">.</span><span class="nx">fetch</span><span class="p">();</span>
        <span class="nx">promise</span><span class="p">.</span><span class="nx">done</span><span class="p">(</span><span class="nx">prxy</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">collection</span><span class="p">){</span>
            <span class="nx">catsCollection</span> <span class="o">=</span> <span class="nx">collection</span><span class="p">;</span>
        <span class="p">}));</span>      
        <span class="nx">whenAsyncDone</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">prxy</span><span class="p">.</span><span class="nx">wasCalled</span><span class="p">(),</span> <span class="s1">'promise.done was called'</span><span class="p">);</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="k">typeof</span> <span class="nx">catsCollection</span> <span class="o">!==</span> <span class="s1">'undefined'</span><span class="p">,</span> <span class="s1">'cat collection was fetched'</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h1>
<a name="installing-preamble" class="anchor" href="#installing-preamble"><span class="octicon octicon-link"></span></a>Installing Preamble</h1>

<p>Whenever you want to create a new environment for creating and running tests just clone the repo into a folder on your computer. That's it!</p>

<h1>
<a name="run-the-sample-test" class="anchor" href="#run-the-sample-test"><span class="octicon octicon-link"></span></a>Run The Sample Test</h1>

<p>After you have cloned the repo you can run the sample test script, javascripts/sample-test.js, by opening index.html, which is located in the repo's root folder, in your browser. All groups, tests and assertions are links and if you click on them Preamble will "drill down" and display details for each, respectively. To repeat the test you can either refresh the browser or click on the <strong>Rerun All Tests</strong> link located near the top of the page. After you have run the sample you can open up the script file in your editor and spy the code, which will give you a feel for how you can use Preamble's API to write your own scripts.</p>

<h1>
<a name="indexhtml" class="anchor" href="#indexhtml"><span class="octicon octicon-link"></span></a>index.html</h1>

<p>The only required tag (other than the script tags) is &lt;div id="preamble-container"&gt;&lt;/div&gt;. The rendering of the results output uses a very nice serif font called Lora (thank you, <a href="http://www.cyreal.org">Cyreal</a> and Google). If you don't like Lora (but who doesn't like Lora?) feel free to remove the link tag or to use a different web font.</p>

<div class="highlight highlight-html"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">"en"</span><span class="nt">&gt;</span>
<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;title&gt;</span>Preamble<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">"viewport"</span> <span class="na">content=</span><span class="s">"width=device-width, initial-scale=1.0"</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">'http://fonts.googleapis.com/css?family=Lora'</span> <span class="na">rel=</span><span class="s">'stylesheet'</span> <span class="na">type=</span><span class="s">'text/css'</span><span class="nt">&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">'stylesheets/preamble.css'</span> <span class="na">rel=</span><span class="s">'stylesheet'</span> <span class="na">type=</span><span class="s">'text/css'</span><span class="nt">&gt;</span>
<span class="nt">&lt;/head&gt;</span>
<span class="nt">&lt;body&gt;</span>
    <span class="c">&lt;!-- This is required. Do not remove or rename the id --&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"preamble-container"</span><span class="nt">&gt;&lt;/div&gt;</span>

    <span class="c">&lt;!-- JavaScripts Go Here --&gt;</span>

    <span class="c">&lt;!-- Place script tags that your tests depend on here --&gt;</span>

    <span class="c">&lt;!-- The preamble-config.js file has to be loaded before preamble.js is loaded!!! --&gt;</span>
    <span class="c">&lt;!--</span>
<span class="c">    &lt;script src="javascripts/preamble-config.js"&gt;&lt;/script&gt;</span>
<span class="c">    --&gt;</span>

    <span class="c">&lt;!-- preamble.js --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"javascripts/preamble.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

    <span class="c">&lt;!-- Place your test script(s) here, immediately following preamble.js --&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"javascripts/sample-test.js"</span><span class="nt">&gt;&lt;/script&gt;</span>

<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>

<h1>
<a name="api" class="anchor" href="#api"><span class="octicon octicon-link"></span></a>API</h1>

<p>Please note that when <strong>windowGlobals</strong> is set to false you must preface each API method listed below with either "Preamble." or with "assert." (please see <strong>Configuration</strong> below).</p>

<div class="highlight highlight-javascript"><pre><span class="nx">Preamble</span><span class="p">.</span><span class="nx">group</span><span class="p">(...)</span>
</pre></div>

<div class="highlight highlight-javascript"><pre><span class="nx">assert</span><span class="p">.</span><span class="nx">isTrue</span><span class="p">(...)</span>
</pre></div>

<h2>
<a name="grouping-tests" class="anchor" href="#grouping-tests"><span class="octicon octicon-link"></span></a>Grouping Tests</h2>

<h3>
<a name="grouplabel-callback" class="anchor" href="#grouplabel-callback"><span class="octicon octicon-link"></span></a>group(label, callback)</h3>

<p>group is used to group together one or more tests. <strong>label</strong> is a string used to uniquely identify the group. <strong>callback</strong> is a function which contains one or more tests. Besides containing tests, <strong>callback</strong> also provide closure which you can use to make data and code accessible to the tests.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'Does it work?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">hw</span> <span class="o">=</span> <span class="s1">'Hello World!'</span><span class="p">;</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">'Hello World!'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="nx">hw</span> <span class="o">===</span> <span class="s1">'Hello World!'</span><span class="p">,</span> <span class="s1">'Yes, it works!'</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">})</span>
</pre></div>

<h3>
<a name="beforeeachtestcallback" class="anchor" href="#beforeeachtestcallback"><span class="octicon octicon-link"></span></a>beforeEachTest(callback)</h3>

<p>beforeEachTest can be used to perform common initialization synchronously prior to calling each test. If <strong>calback</strong> returns a value it is passed to each test as either its 1st or 2nd parameter (for more information please see <strong>Configuration</strong> below). If you need to do both synchronous and asynchronous initialization before each test then use asyncBeforeEachTest (please see asyncBeforeEachTest below).</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'2 slightly convoluted synchronous test with "beforeEachTest".'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">beforeEachTest</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nx">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">'Is count 1?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 0'</span><span class="p">);</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'count does equal 1'</span><span class="p">);</span>
        <span class="nx">isTrue</span><span class="p">((</span><span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">===</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'count now equals 2'</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">'Is count still 2?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">'nope, it isn\'t still 2'</span><span class="p">);</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'now count equals 1'</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="aftereachtestcallback" class="anchor" href="#aftereachtestcallback"><span class="octicon octicon-link"></span></a>afterEachTest(callback)</h3>

<p>afterEachTest can be used to perform common initialization synchronously after each test is called.  If you need to do both synchronous and asynchronous initialization after each test then use asyncAfterEachTest (please see asyncAfterEachTest below).</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'2 slightly convoluted synchronous test with "afterEachTest".'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">afterEachTest</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nx">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">'Is count 0?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'count does equal 0.'</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">'Is count still 0?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 0.'</span><span class="p">);</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'count now equals 1.'</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="asyncbeforeeachtestinterval-callback" class="anchor" href="#asyncbeforeeachtestinterval-callback"><span class="octicon octicon-link"></span></a>asyncBeforeEachTest([interval,] callback)</h3>

<p>asyncBeforeEachTest can be used to perform common initialization asynchronously prior to calling each test. <strong>interval</strong> is optional and can be used to override the default amount of time expressed in milliseconds that Preamble will wait before running the test. If <strong>calback</strong> returns a value it is passed to each test as either its 1st or 2nd parameter (for more information please see <strong>Configuration</strong> below).</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'2 slightly convoluted asynchronous tests with "asyncBeforeEachTest".'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">asyncBeforeEachTest</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nx">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="nx">asyncTest</span><span class="p">(</span><span class="s1">'Is count 1?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 0 anymore'</span><span class="p">);</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'count equals 1.'</span><span class="p">);</span>
            <span class="nx">count</span> <span class="o">*=</span> <span class="mi">10</span><span class="p">;</span>
        <span class="p">},</span> <span class="mi">10</span><span class="p">);</span>

        <span class="nx">whenAsyncDone</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 0 anymore'</span><span class="p">);</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 1 anymore'</span><span class="p">);</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">'now count equals 10'</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
    <span class="nx">asyncTest</span><span class="p">(</span><span class="s1">'Is count 10?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">'count doesn\'t equals 10 anymore.'</span><span class="p">);</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'count now equals 1 again.'</span><span class="p">);</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">count</span> <span class="o">*=</span> <span class="mi">100</span><span class="p">;</span>
        <span class="p">},</span> <span class="mi">10</span><span class="p">);</span>

        <span class="nx">whenAsyncDone</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 0 anymore'</span><span class="p">);</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 1 anymore'</span><span class="p">);</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 10 anymore'</span><span class="p">);</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'count now equals 100'</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="asyncaftereachtestinterval-callback" class="anchor" href="#asyncaftereachtestinterval-callback"><span class="octicon octicon-link"></span></a>asyncAfterEachTest([interval,] callback)</h3>

<p>asyncAfterEachTest can be used to perform common initialization asynchronously after each test is called. <strong>interval</strong> is optional and can be used to override the default amount of time expressed in milliseconds that Preamble will wait before running the next test in the group. </p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'2 slightly convoluted asynchronous tests with "asyncAfterEachTest".'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="kd">var</span> <span class="nx">count</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">asyncAfterEachTest</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="nx">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
    <span class="p">});</span>
    <span class="nx">asyncTest</span><span class="p">(</span><span class="s1">'Is count 1?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">count</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
        <span class="p">},</span> <span class="mi">10</span><span class="p">);</span>

        <span class="nx">whenAsyncDone</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 0 anymore'</span><span class="p">);</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'count doesn\'t equal 1 anymore'</span><span class="p">);</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">'now count equals 10'</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
    <span class="nx">asyncTest</span><span class="p">(</span><span class="s1">'Is count still 10?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="nx">isFalse</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">'count doesn\'t equals 10 anymore.'</span><span class="p">);</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">'count now equals 1 again.'</span><span class="p">);</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">count</span> <span class="o">*=</span> <span class="mi">100</span><span class="p">;</span>
        <span class="p">},</span> <span class="mi">10</span><span class="p">);</span>

        <span class="nx">whenAsyncDone</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">count</span> <span class="o">===</span> <span class="mi">100</span><span class="p">,</span> <span class="s1">'count now equals 100'</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="synchronous-tests" class="anchor" href="#synchronous-tests"><span class="octicon octicon-link"></span></a>Synchronous Tests</h2>

<h3>
<a name="testlabel-callbackbeforetestvalue--callbackassert-beforetestvalue" class="anchor" href="#testlabel-callbackbeforetestvalue--callbackassert-beforetestvalue"><span class="octicon octicon-link"></span></a>test(label, callback([beforeTestValue]) || callback(assert[, beforeTestValue]))</h3>

<p>test is used to group together one or more assertions that are to be run synchronously. <strong>label</strong> is a string used to uniquely identify a test within a group. <strong>callback</strong> is a function which contains one or more assertions. Besides containing assertions, <strong>callback</strong> can also provide closure which you can use to make data and code accessible to the assertions. If your tests are initialized prior to being called (see beforeEachTest above) and initialization returns a value then Preamble will pass the returned value on to <strong>callback</strong> either as the 1st parameter if <strong>windowGlobals</strong> is set to true or as the 2nd parameter if <strong>windowGlobals</strong> is set to false (for more information please see <strong>Configuration</strong> below). <strong>assert</strong> is an object whose properties are the assertion methods (please see Assertions below).</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'Does it work?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">test</span><span class="p">(</span><span class="s1">'Hello World!'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">hw</span> <span class="o">=</span> <span class="s1">'Hello World!'</span><span class="p">;</span>
        <span class="nx">isTrue</span><span class="p">(</span><span class="nx">hw</span> <span class="o">===</span> <span class="s1">'Hello World!'</span><span class="p">,</span> <span class="s1">'Yes, it works!'</span><span class="p">);</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h2>
<a name="asynchronous-tests" class="anchor" href="#asynchronous-tests"><span class="octicon octicon-link"></span></a>Asynchronous Tests</h2>

<h3>
<a name="asynctestlabel-interval-callbackbeforetestvalue--callbackassert-beforetestvalue" class="anchor" href="#asynctestlabel-interval-callbackbeforetestvalue--callbackassert-beforetestvalue"><span class="octicon octicon-link"></span></a>asyncTest(label, [interval,] callback([beforeTestValue]) || callback(assert[, beforeTestValue]))</h3>

<p>asyncTest is used to group together one or more assertions that are to be run asynchronously. <strong>label</strong> is a string used to uniquely identify a test within a group. <strong>callback</strong> is a function which contains one or more assertions. Besides containing assertions, <strong>callback</strong> can also provide closure which you can use to make data and code accessible to the assertions. If your tests are initialized prior to being called (see beforeEachTest above) and initialization returns a value then Preamble will pass the returned value on to <strong>callback</strong> either as the 1st parameter if <strong>windowGlobals</strong> is set to true or as the 2nd parameter if <strong>windowGlobals</strong> is set to false (for more information please see <strong>Configuration</strong> below). <strong>assert</strong> is an object whose properties are the assertion methods (please see Assertions below).</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'A simple asynchronous test'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">asyncTest</span><span class="p">(</span><span class="s1">'Isn\'t JavaScript amazing?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">val</span><span class="p">;</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">val</span> <span class="o">=</span> <span class="s1">'Isn\'t JavaScript amazing?'</span><span class="p">;</span>
        <span class="p">},</span> <span class="mi">10</span><span class="p">);</span>
        <span class="nx">whenAsyncDone</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">val</span> <span class="o">===</span> <span class="s1">'Isn\'t JavaScript amazing?'</span><span class="p">,</span> <span class="s1">'Yest it is!'</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="whenasyncdonecallback" class="anchor" href="#whenasyncdonecallback"><span class="octicon octicon-link"></span></a>whenAsyncDone(callback)</h3>

<p>whenAsynDone starts the timer for an asyncTest. When the timer expires Preamble will then call <strong>callback</strong> to run the assertions for the asyncTest. </p>

<h2>
<a name="assertions" class="anchor" href="#assertions"><span class="octicon octicon-link"></span></a>Assertions</h2>

<h3>
<a name="equalvalue-expectation-label" class="anchor" href="#equalvalue-expectation-label"><span class="octicon octicon-link"></span></a>equal(value, expectation, label)</h3>

<p>A deep recursive comparison of <strong>value</strong> and <strong>expection</strong>. <strong>value</strong> and <strong>expectation</strong> can be any valid JavaScript primitive value or object (including functions). When comparing objects the comparison is made such that if value === expectation &amp;&amp; expectation === value then the result will be true. <strong>label</strong> is a string used to uniquely identify the assertion.</p>

<h3>
<a name="notequalvalue-expectation-label" class="anchor" href="#notequalvalue-expectation-label"><span class="octicon octicon-link"></span></a>notEqual(value, expectation, label)</h3>

<p>A deep recursive comparison of <strong>value</strong> and <strong>expection</strong>. <strong>value</strong> and <strong>expectation</strong> can be any valid JavaScript primitive value or object (including functions). When comparing objects the comparison is made such that if value !== expectation &amp;&amp; expectation !== value then the result will be true. <strong>label</strong> is a string used to uniquely identify the assertion.</p>

<h3>
<a name="istruevalue-label" class="anchor" href="#istruevalue-label"><span class="octicon octicon-link"></span></a>isTrue(value, label)</h3>

<p>A boolean assertion comparing <strong>value</strong> to true. Result is true if <strong>value</strong> is truthy. <strong>label</strong> is a string used to uniquely identify the assertion.</p>

<h3>
<a name="isfalsevalue-label" class="anchor" href="#isfalsevalue-label"><span class="octicon octicon-link"></span></a>isFalse(value, label)</h3>

<p>A boolean assertion comparing <strong>value</strong> to false. Result is true if <strong>value</strong> is not truthy. <strong>label</strong> is a string used to uniquely identify the assertion.</p>

<h2>
<a name="ui-tests" class="anchor" href="#ui-tests"><span class="octicon octicon-link"></span></a>UI Tests</h2>

<p>Preamble adds a div element, whose ID is <em>**ui-test-container</em>*, to the DOM which can be used to perform UI tests. </p>

<h2>
<a name="helpersconvenience-methods" class="anchor" href="#helpersconvenience-methods"><span class="octicon octicon-link"></span></a>Helpers/Convenience Methods</h2>

<h3>
<a name="proxy" class="anchor" href="#proxy"><span class="octicon octicon-link"></span></a>proxy()</h3>

<p>proxy is a factory method that returns a function that can wrap a callback and which can be used to determine if the callback was actually called and if the callback was called n times.</p>

<div class="highlight highlight-javascript"><pre><span class="nx">group</span><span class="p">(</span><span class="s1">'Using "proxy" to determine if its callback was called.'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
    <span class="nx">asyncTest</span><span class="p">(</span><span class="s1">'Was callback called?'</span><span class="p">,</span> <span class="kd">function</span><span class="p">(){</span>
        <span class="kd">var</span> <span class="nx">prxy</span> <span class="o">=</span> <span class="nx">proxy</span><span class="p">();</span>
        <span class="nx">setTimeout</span><span class="p">(</span><span class="nx">prxy</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
        <span class="p">}),</span> <span class="mi">10</span><span class="p">);</span>
        <span class="nx">whenAsyncDone</span><span class="p">(</span><span class="kd">function</span><span class="p">(){</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">prxy</span><span class="p">.</span><span class="nx">wasCalled</span><span class="p">(),</span> <span class="s1">'Yest it was called!'</span><span class="p">);</span>
            <span class="nx">isFalse</span><span class="p">(</span><span class="nx">prxy</span><span class="p">.</span><span class="nx">wasCalled</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="s1">'And it was not called twice!'</span><span class="p">);</span>
            <span class="nx">isTrue</span><span class="p">(</span><span class="nx">prxy</span><span class="p">.</span><span class="nx">wasCalled</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="s1">'It was called once!'</span><span class="p">);</span>
        <span class="p">});</span>
    <span class="p">});</span>
<span class="p">});</span>
</pre></div>

<h3>
<a name="getuitestcontainerelement" class="anchor" href="#getuitestcontainerelement"><span class="octicon octicon-link"></span></a>getUiTestContainerElement()</h3>

<p>Returns the &lt;div id="ui-test-container"&gt; element which can be used to do UI testing (please see UI Tests abouve).</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">$uiTestContainerElement</span> <span class="o">=</span> <span class="nx">$</span><span class="p">(</span><span class="nx">getUiTestContainerElement</span><span class="p">());</span>
</pre></div>

<h3>
<a name="getuitestcontainerelementid" class="anchor" href="#getuitestcontainerelementid"><span class="octicon octicon-link"></span></a>getUiTestContainerElementId()</h3>

<p>Returns the id of the &lt;div id="ui-test-container"&gt; element which can be used to do UI testing (please see UI Tests abouve).</p>

<div class="highlight highlight-javascript"><pre><span class="kd">var</span> <span class="nx">elUiTestContainerElement</span> <span class="o">=</span> 
    <span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="nx">getUiTestContainerElementId</span><span class="p">());</span>
</pre></div>

<h2>
<a name="configuration" class="anchor" href="#configuration"><span class="octicon octicon-link"></span></a>Configuration</h2>

<p>The following configuration options can be overridden in the preamble-config.js file located in the javascripts folder:</p>

<h3>
<a name="shortcircuit-default-value--false-set-to-true-to-terminate-upon-first-failure" class="anchor" href="#shortcircuit-default-value--false-set-to-true-to-terminate-upon-first-failure"><span class="octicon octicon-link"></span></a>shortCircuit: Default value = false. Set to true to terminate upon first failure.</h3>

<h3>
<a name="windowglobals-default-value--true-set-to-false-if-you-dont-want-to-pollute-the-global-name-space-and-instead-use-the-two-global-vars-preamble-and-assert" class="anchor" href="#windowglobals-default-value--true-set-to-false-if-you-dont-want-to-pollute-the-global-name-space-and-instead-use-the-two-global-vars-preamble-and-assert"><span class="octicon octicon-link"></span></a>windowGlobals: Default value = true. Set to false if you don't want to pollute the global name space and instead use the two global vars 'Preamble' and 'assert'.</h3>

<h3>
<a name="asynctestdelay-default-value--500-set-the-value-used-to-wait-before-calling-whenasyncdones-callback" class="anchor" href="#asynctestdelay-default-value--500-set-the-value-used-to-wait-before-calling-whenasyncdones-callback"><span class="octicon octicon-link"></span></a>asyncTestDelay: Default value = 500. Set the value used to wait before calling whenAsyncDone's callback.</h3>

<h3>
<a name="asyncbeforeaftertestdelay-default-value--500-set-the-value-used-to-wait-before-calling-the-tests-callback-asyncbeforeeachtest-and-when-calling-the-next-tests-callback-asyncaftereachtest" class="anchor" href="#asyncbeforeaftertestdelay-default-value--500-set-the-value-used-to-wait-before-calling-the-tests-callback-asyncbeforeeachtest-and-when-calling-the-next-tests-callback-asyncaftereachtest"><span class="octicon octicon-link"></span></a>asyncBeforeAfterTestDelay: Default value = 500. Set the value used to wait before calling the test's callback (asyncBeforeEachTest) and when calling the next test's callback (asyncAfterEachTest).</h3>

<h3>
<a name="name-default-value--test-override-this-to-display-a-meaningful-name-for-your-tests" class="anchor" href="#name-default-value--test-override-this-to-display-a-meaningful-name-for-your-tests"><span class="octicon octicon-link"></span></a>name: Default value = 'Test'. Override this to display a meaningful name for your tests.</h3>

<h3>
<a name="uitestcontainerid-default-value--ui-test-container-override-this-to-use-a-different-id" class="anchor" href="#uitestcontainerid-default-value--ui-test-container-override-this-to-use-a-different-id"><span class="octicon octicon-link"></span></a>uiTestContainerId: Default value = 'ui-test-container'. Override this to use a different id.</h3>

<h2>
<a name="running-headless" class="anchor" href="#running-headless"><span class="octicon octicon-link"></span></a>Running Headless</h2>

<p>You can run tests with Preamble headless using <a href="http://phantomjs.org">PhantomJS</a>. The following example assumes that you already have PhantomJS installed and that it can be found on the path.</p>

<ol>
<li>Open up a terminal and change to your test's root folder.</li>
<li>From the command line type phantomjs javascripts/phantom-runner.js index.html </li>
</ol>
      </section>
      <footer>
        <p><small>Hosted on <a href="https://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>